{
  "name": "gitgathom",
  "displayName": "GitFathom",
  "description": "Generate git commit messages from repository changes with configurable AI providers.",
  "version": "0.5.3",
  "publisher": "slocean",
  "license": "UNLICENSED",
  "repository": {
    "type": "git",
    "url": "https://github.com/Slocean/GitFathom.git"
  },
  "engines": {
    "vscode": "^1.90.0"
  },
  "categories": [
    "SCM Providers",
    "Other"
  ],
  "activationEvents": [
    "onCommand:gitgathom.generateCommitMessage",
    "onCommand:gitgathom.openSetup",
    "onCommand:gitgathom.showLastDebugReport"
  ],
  "main": "./dist/extension.js",
  "icon": "src/img/logo.png",
  "contributes": {
    "commands": [
      {
        "command": "gitgathom.generateCommitMessage",
        "title": "AI 生成提交信息 / Generate Commit Message",
        "category": "GitFathom",
        "icon": {
          "light": "src/img/btn_light.png",
          "dark": "src/img/btn_dark.png"
        }
      },
      {
        "command": "gitgathom.openSetup",
        "title": "打开配置向导 / Open Setup Wizard",
        "category": "GitFathom"
      },
      {
        "command": "gitgathom.showLastDebugReport",
        "title": "显示最近 AI 调试报告 / Show Last AI Debug Report",
        "category": "GitFathom"
      }
    ],
    "menus": {
      "scm/title": [
        {
          "command": "gitgathom.generateCommitMessage",
          "when": "scmProvider == git",
          "group": "navigation@90",
          "icon": {
            "light": "src/img/light_btn.png",
            "dark": "src/img/dark-btn.png"
          }
        }
      ]
    },
    "configuration": {
      "title": "GitFathom",
      "properties": {
        "gitgathom.language": {
          "type": "string",
          "title": "语言",
          "default": "zh",
          "enum": [
            "zh",
            "en"
          ],
          "enumItemLabels": [
            "中文",
            "English"
          ],
          "enumDescriptions": [
            "简体中文",
            "English"
          ],
          "markdownDescription": "界面语言与提交信息语言。"
        },
        "gitgathom.provider": {
          "type": "string",
          "title": "AI 厂商",
          "default": "openai",
          "enum": [
            "openai",
            "deepseek",
            "gemini",
            "kimi",
            "glm",
            "custom"
          ],
          "enumItemLabels": [
            "OpenAI",
            "DeepSeek",
            "Gemini",
            "Kimi（月之暗面）",
            "GLM（智谱）",
            "自定义兼容厂商"
          ],
          "markdownDescription": "AI 厂商选择（custom 使用 OpenAI 兼容接口）。"
        },
        "gitgathom.model": {
          "type": "string",
          "default": "",
          "title": "模型名",
          "markdownDescription": "模型名称，留空则使用厂商默认模型。"
        },
        "gitgathom.apiKey": {
          "type": "string",
          "default": "",
          "title": "API Key",
          "markdownDescription": "厂商 API Key，也可使用环境变量（OPENAI_API_KEY、DEEPSEEK_API_KEY、GEMINI_API_KEY、MOONSHOT_API_KEY、ZHIPU_API_KEY、GITFATHOM_API_KEY）。"
        },
        "gitgathom.baseUrl": {
          "type": "string",
          "default": "",
          "title": "Base URL",
          "markdownDescription": "自定义 Base URL（支持第三方网关或代理）。"
        },
        "gitgathom.customRequestPath": {
          "type": "string",
          "default": "",
          "title": "请求路径",
          "markdownDescription": "请求路径。OpenAI 默认使用 /chat/completions；其它厂商默认留空，可手动填写。"
        },
        "gitgathom.extraHeaders": {
          "type": "string",
          "default": "{}",
          "title": "额外请求头",
          "markdownDescription": "额外 HTTP 请求头的 JSON，例如 {\"X-Api-Key\":\"...\"}。"
        },
        "gitgathom.detailedOutput": {
          "type": "boolean",
          "default": true,
          "title": "详细输出",
          "markdownDescription": "开启后使用详细输出规则；关闭后每条改动只输出一句话概括。"
        },
        "gitgathom.ruleTemplate": {
          "type": "string",
          "default": "",
          "title": "规则模板",
          "markdownDescription": "提交信息生成的主规则模板，留空则使用内置默认值。"
        },
        "gitgathom.additionalRules": {
          "type": "string",
          "default": "",
          "title": "附加规则",
          "markdownDescription": "附加到规则模板后的额外指令。"
        },
        "gitgathom.systemPrompt": {
          "type": "string",
          "default": "",
          "title": "系统提示词",
          "markdownDescription": "控制生成风格的系统提示词，留空则使用内置默认值。"
        },
        "gitgathom.copyToClipboard": {
          "type": "boolean",
          "default": false,
          "title": "复制到剪贴板",
          "markdownDescription": "生成后同时复制到剪贴板。"
        },
        "gitgathom.includeOnlyStaged": {
          "type": "boolean",
          "default": false,
          "title": "仅包含暂存区",
          "markdownDescription": "开启后仅包含暂存区变更。"
        },
        "gitgathom.maxChangedFiles": {
          "type": "number",
          "default": 30,
          "minimum": 1,
          "maximum": 500,
          "title": "最大变更文件数",
          "markdownDescription": "发送给 AI 的最大变更文件数量。"
        },
        "gitgathom.truncateDiff": {
          "type": "boolean",
          "default": true,
          "title": "启用 Diff 截断",
          "markdownDescription": "是否对总 diff 内容按字节截断。关闭后不截断。"
        },
        "gitgathom.maxDiffBytes": {
          "type": "number",
          "default": 120000,
          "minimum": 4096,
          "maximum": 2097152,
          "title": "Diff 最大字节数",
          "markdownDescription": "发送给模型的 diff UTF-8 最大字节数（仅在启用 Diff 截断时生效）。"
        },
        "gitgathom.temperature": {
          "type": "number",
          "default": 0.2,
          "minimum": 0,
          "maximum": 2,
          "title": "温度",
          "markdownDescription": "生成采样温度。"
        },
        "gitgathom.maxTokens": {
          "type": [
            "number",
            "null"
          ],
          "default": null,
          "minimum": 16,
          "maximum": 2048,
          "title": "最大输出 Token",
          "markdownDescription": "输出的最大 Token 数。设为 null 表示不限制（由厂商默认控制）。"
        },
        "gitgathom.requestTimeoutMs": {
          "type": "number",
          "default": 25000,
          "minimum": 3000,
          "maximum": 120000,
          "title": "请求超时（毫秒）",
          "markdownDescription": "HTTP 请求超时（毫秒）。"
        },
        "gitgathom.commandTimeoutMs": {
          "type": "number",
          "default": 12000,
          "minimum": 3000,
          "maximum": 120000,
          "title": "命令超时（毫秒）",
          "markdownDescription": "Git 命令超时（毫秒）。"
        },
        "gitgathom.debugView": {
          "type": "boolean",
          "default": false,
          "title": "AI 调试可视化",
          "markdownDescription": "开启后生成提交信息会自动打开调试文档，展示 AI 输入与回复（已脱敏）。"
        }
      }
    }
  },
  "scripts": {
    "compile": "tsc -p ./",
    "watch": "tsc -watch -p ./",
    "lint": "tsc -noEmit -p ./",
    "vscode:prepublish": "npm run compile"
  },
  "devDependencies": {
    "@types/node": "^20.17.57",
    "@types/vscode": "^1.90.0",
    "typescript": "^5.6.3"
  }
}
